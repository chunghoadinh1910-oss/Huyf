local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")

if CoreGui:FindFirstChild("VuaBuaChu_Final") then CoreGui:FindFirstChild("VuaBuaChu_Final"):Destroy() end

local ScreenGui = Instance.new("ScreenGui", CoreGui)
ScreenGui.Name = "VuaBuaChu_Final"

-- [ GIAO DIá»†N ] --
local LoginFrame = Instance.new("Frame", ScreenGui)
LoginFrame.Size = UDim2.new(0, 380, 0, 260)
LoginFrame.Position = UDim2.new(0.5, -190, 0.5, -130)
LoginFrame.BackgroundColor3 = Color3.fromRGB(10, 0, 20)
Instance.new("UIStroke", LoginFrame).Color = Color3.fromRGB(255, 0, 0)
Instance.new("UICorner", LoginFrame)

local KeyBox = Instance.new("TextBox", LoginFrame)
KeyBox.Size = UDim2.new(0.9, 0, 0, 100)
KeyBox.Position = UDim2.new(0.05, 0, 0.15, 0)
KeyBox.PlaceholderText = "DÃN BÃ™A CHÃš VÃ€O ÄÃ‚Y..."
KeyBox.Text = ""
KeyBox.TextWrapped = true
KeyBox.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
KeyBox.TextColor3 = Color3.new(1, 1, 1)
KeyBox.TextSize = 8

local LoginBtn = Instance.new("TextButton", LoginFrame)
LoginBtn.Size = UDim2.new(0.45, 0, 0, 45)
LoginBtn.Position = UDim2.new(0.03, 0, 0.7, 0)
LoginBtn.Text = "GIáº¢I BÃ™A"
LoginBtn.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
LoginBtn.TextColor3 = Color3.new(1, 1, 1)

local GetKeyBtn = Instance.new("TextButton", LoginFrame)
GetKeyBtn.Size = UDim2.new(0.45, 0, 0, 45)
GetKeyBtn.Position = UDim2.new(0.52, 0, 0.7, 0)
GetKeyBtn.Text = "Láº¤Y BÃ™A"
GetKeyBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
GetKeyBtn.TextColor3 = Color3.new(1, 1, 1)

-- [ LOGIC GIáº¢I BÃ™A ] --
LoginBtn.MouseButton1Click:Connect(function()
    local input = KeyBox.Text
    LoginBtn.Text = "ÄANG GIáº¢I áº¤N..."
    
    local success, response = pcall(function()
        return game:HttpGet("https://raw.githubusercontent.com/chunghoadinh1910-oss/Huyf/refs/heads/main/database.json?t=" .. os.time())
    end)

    if success then
        local data = HttpService:JSONDecode(response)
        local foundData = nil
        
        -- CÆ  CHáº¾ SO SÃNH THÃ”NG MINH
        for keyInDb, value in pairs(data) do
            -- Náº¿u key giá»‘ng há»‡t HOáº¶C key trong database náº±m trong chuá»—i vá»«a dÃ¡n
            if keyInDb == input or string.find(input, "ADMIN_VOID") or string.find(input, "ABYSS_WATCHER") then
                -- Náº¿u lÃ  key Admin Ä‘áº·c biá»‡t cá»§a báº¡n, cho qua luÃ´n
                if string.find(keyInDb, "ADMIN") and string.find(input, "ADMIN") then
                    foundData = value
                    break
                end
            end
            
            -- Kiá»ƒm tra key thÆ°á»ng (Free/Vip)
            if keyInDb == input then
                foundData = value
                break
            end
        end

        if foundData then
            LoginBtn.Text = "THÃ€NH CÃ”NG!"
            wait(0.5)
            LoginFrame.Visible = false
            _G.OpenMenu(foundData.Type, foundData.Expiry)
        else
            LoginBtn.Text = "SAI BÃ™A CHÃš!"
            wait(1.5)
            LoginBtn.Text = "GIáº¢I BÃ™A Láº I"
        end
    else
        LoginBtn.Text = "Lá»–I Káº¾T Ná»I!"
    end
end)

GetKeyBtn.MouseButton1Click:Connect(function()
    setclipboard("https://discord.gg/vua-bua-chu")
    print("Link copied!")
end)

-- [ MENU CHá»¨C NÄ‚NG (GIá»® NGUYÃŠN TÃC Dá»¤NG) ] --
_G.OpenMenu = function(kType, expiry)
    local MainMenu = Instance.new("Frame", ScreenGui)
    MainMenu.Size = UDim2.new(0, 400, 0, 320)
    MainMenu.Position = UDim2.new(0.5, -200, 0.5, -160)
    MainMenu.BackgroundColor3 = Color3.fromRGB(5, 5, 5)
    Instance.new("UIStroke", MainMenu).Color = Color3.fromRGB(255, 0, 0)
    MainMenu.Draggable = true
    MainMenu.Active = true

    local Title = Instance.new("TextLabel", MainMenu)
    Title.Text = "ðŸ”® VUA BÃ™A CHÃš - " .. kType:upper()
    Title.Size = UDim2.new(1,0,0,50)
    Title.TextColor3 = Color3.new(1,0,0)
    Title.BackgroundTransparency = 1
    Title.TextSize = 20

    -- NÃºt Auto Farm (TÃ¡c dá»¥ng ban Ä‘áº§u)
    local FarmBtn = Instance.new("TextButton", MainMenu)
    FarmBtn.Size = UDim2.new(0.9, 0, 0, 45)
    FarmBtn.Position = UDim2.new(0.05, 0, 0.25, 0)
    FarmBtn.Text = "Báº¬T AUTO FARM ITEMS"
    FarmBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    FarmBtn.TextColor3 = Color3.new(1, 1, 1)

    local isFarming = false
    FarmBtn.MouseButton1Click:Connect(function()
        isFarming = not isFarming
        FarmBtn.Text = isFarming and "ÄANG FARM (ON)" or "Báº¬T AUTO FARM ITEMS"
        FarmBtn.BackgroundColor3 = isFarming and Color3.new(0, 0.5, 0) or Color3.fromRGB(30,30,30)
        
        while isFarming do
            pcall(function()
                for _, v in pairs(game.Workspace:GetDescendants()) do
                    if v:IsA("TouchTransmitter") then
                        Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.Parent.CFrame
                        wait(0.15)
                    end
                end
            end)
            wait(0.1)
        end
    end)
    
    -- Hiá»ƒn thá»‹ háº¡n dÃ¹ng
    local TimeL = Instance.new("TextLabel", MainMenu)
    TimeL.Size = UDim2.new(1,0,0,30)
    TimeL.Position = UDim2.new(0,0,1,-30)
    TimeL.TextColor3 = Color3.new(1,1,1)
    TimeL.BackgroundTransparency = 1
    spawn(function()
        while wait(1) do
            if expiry > 2000000000 then TimeL.Text = "Háº N: VÄ¨NH Háº°NG"
            else TimeL.Text = "Háº N CÃ’N: " .. math.floor((expiry - os.time())/3600) .. " GIá»œ" end
        end
    end)
end
