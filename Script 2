-- [[ VUA B√ôA CH√ö - FIXED INTERFACE ]] --
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")

-- X√≥a Menu c≈© n·∫øu c√≥ ƒë·ªÉ tr√°nh tr√πng l·∫∑p
if CoreGui:FindFirstChild("VuaBuaChu_Main") then
    CoreGui:FindFirstChild("VuaBuaChu_Main"):Destroy()
end

local ScreenGui = Instance.new("ScreenGui", CoreGui)
ScreenGui.Name = "VuaBuaChu_Main"

-- [ FRAME ƒêƒÇNG NH·∫¨P ] --
local LoginFrame = Instance.new("Frame", ScreenGui)
LoginFrame.Size = UDim2.new(0, 380, 0, 250)
LoginFrame.Position = UDim2.new(0.5, -190, 0.5, -125)
LoginFrame.BackgroundColor3 = Color3.fromRGB(15, 0, 25)
LoginFrame.Active = true
LoginFrame.Draggable = true -- Cho ph√©p k√©o menu

local Stroke = Instance.new("UIStroke", LoginFrame)
Stroke.Color = Color3.fromRGB(255, 0, 0)
Stroke.Thickness = 2

Instance.new("UICorner", LoginFrame)

local Title = Instance.new("TextLabel", LoginFrame)
Title.Text = "üîÆ VUA B√ôA CH√ö üîÆ"
Title.Size = UDim2.new(1, 0, 0, 50)
Title.TextColor3 = Color3.fromRGB(255, 0, 0)
Title.Font = Enum.Font.Creepster
Title.TextSize = 25
Title.BackgroundTransparency = 1

local KeyBox = Instance.new("TextBox", LoginFrame)
KeyBox.Size = UDim2.new(0.9, 0, 0, 50)
KeyBox.Position = UDim2.new(0.05, 0, 0.3, 0)
KeyBox.PlaceholderText = "D√ÅN B√ôA CH√ö V√ÄO ƒê√ÇY..."
KeyBox.Text = ""
KeyBox.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
KeyBox.TextColor3 = Color3.new(1, 1, 1)
KeyBox.TextScaled = true

local LoginBtn = Instance.new("TextButton", LoginFrame)
LoginBtn.Size = UDim2.new(0.45, 0, 0, 45)
LoginBtn.Position = UDim2.new(0.03, 0, 0.65, 0)
LoginBtn.Text = "GI·∫¢I B√ôA"
LoginBtn.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
LoginBtn.TextColor3 = Color3.new(1, 1, 1)

local GetKeyBtn = Instance.new("TextButton", LoginFrame)
GetKeyBtn.Size = UDim2.new(0.45, 0, 0, 45)
GetKeyBtn.Position = UDim2.new(0.52, 0, 0.65, 0)
GetKeyBtn.Text = "L·∫§Y B√ôA"
GetKeyBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
GetKeyBtn.TextColor3 = Color3.new(1, 1, 1)

-- [ LOGIC KI·ªÇM TRA KEY ] --
LoginBtn.MouseButton1Click:Connect(function()
    local inputKey = KeyBox.Text:gsub("%s+", "") -- X√≥a kho·∫£ng tr·∫Øng
    if inputKey == "" then return end

    LoginBtn.Text = "ƒêANG KI·ªÇM TRA..."
    
    local success, response = pcall(function()
        return game:HttpGet("https://raw.githubusercontent.com/chunghoadinh1910-oss/Huyf/refs/heads/main/database.json?t=" .. os.time())
    end)

    if success then
        local data = HttpService:JSONDecode(response)
        local found = false
        
        for k, v in pairs(data) do
            if k == inputKey then
                found = v
                break
            end
        end

        if found then
            LoginBtn.Text = "TH√ÄNH C√îNG!"
            wait(0.5)
            LoginFrame.Visible = false
            -- M·ªü Menu Ch·ª©c NƒÉng (T√°c d·ª•ng nh∆∞ ban ƒë·∫ßu)
            _G.StartBuaChu(found.Type, found.Expiry)
        else
            LoginBtn.Text = "SAI B√ôA CH√ö!"
            wait(1)
            LoginBtn.Text = "GI·∫¢I B√ôA"
        end
    else
        LoginBtn.Text = "L·ªñI K·∫æT N·ªêI!"
        wait(1)
        LoginBtn.Text = "GI·∫¢I B√ôA"
    end
end)

GetKeyBtn.MouseButton1Click:Connect(function()
    setclipboard("https://discord.gg/vua-bua-chu")
    game:GetService("StarterGui"):SetCore("SendNotification", {Title="H·ªá Th·ªëng", Text="ƒê√£ copy link Discord!"})
end)

-- [ MENU CH√çNH (T√ÅC D·ª§NG NH∆Ø BAN ƒê·∫¶U) ] --
_G.StartBuaChu = function(kType, expiry)
    local MainMenu = Instance.new("Frame", ScreenGui)
    MainMenu.Size = UDim2.new(0, 400, 0, 300)
    MainMenu.Position = UDim2.new(0.5, -200, 0.5, -150)
    MainMenu.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    MainMenu.Draggable = true
    MainMenu.Active = true
    Instance.new("UIStroke", MainMenu).Color = Color3.fromRGB(255, 0, 0)
    
    local Title = Instance.new("TextLabel", MainMenu)
    Title.Text = "MENU: " .. kType:upper()
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.TextColor3 = Color3.new(1, 0, 0)
    Title.BackgroundTransparency = 1

    -- T√≠nh nƒÉng Auto Farm Items
    local FarmBtn = Instance.new("TextButton", MainMenu)
    FarmBtn.Size = UDim2.new(0.8, 0, 0, 40)
    FarmBtn.Position = UDim2.new(0.1, 0, 0.3, 0)
    FarmBtn.Text = "AUTO FARM BRAINROT"
    
    local farming = false
    FarmBtn.MouseButton1Click:Connect(function()
        farming = not farming
        FarmBtn.BackgroundColor3 = farming and Color3.new(0, 1, 0) or Color3.new(0.2, 0.2, 0.2)
        while farming do
            pcall(function()
                for _, v in pairs(game:GetService("Workspace"):GetDescendants()) do
                    if v:IsA("TouchTransmitter") then
                        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.Parent.CFrame
                        wait(0.15)
                    end
                end
            end)
            wait(0.1)
        end
    end)

    -- Hi·ªÉn th·ªã th·ªùi gian vƒ©nh h·∫±ng/c√≤n l·∫°i
    local TimeLabel = Instance.new("TextLabel", MainMenu)
    TimeLabel.Size = UDim2.new(1, 0, 0, 30)
    TimeLabel.Position = UDim2.new(0, 0, 1, -30)
    TimeLabel.TextColor3 = Color3.new(1,1,1)
    TimeLabel.BackgroundTransparency = 1
    
    spawn(function()
        while wait(1) do
            local diff = expiry - os.time()
            if expiry > 2000000000 then
                TimeLabel.Text = "‚è≥ Hi·ªáu l·ª±c: Vƒ®NH H·∫∞NG"
            else
                TimeLabel.Text = "‚è≥ C√≤n l·∫°i: " .. math.floor(diff/3600) .. " gi·ªù"
            end
        end
    end)
end
