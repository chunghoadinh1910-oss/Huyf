local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local Workspace = game:GetService("Workspace")

local Config = {
    RawUrl = "https://raw.githubusercontent.com/chunghoadinh1910-oss/Huyf/refs/heads/main/database.json",
    HWID = game:GetService("RbxAnalyticsService"):GetClientId(),
    GetKeyLink = "https://discord.gg/vua-bua-chu" -- Thay link c·ªßa b·∫°n
}

local ScreenGui = Instance.new("ScreenGui", CoreGui)

-- [ GIAO DI·ªÜN ƒêƒÇNG NH·∫¨P ] --
local LoginFrame = Instance.new("Frame", ScreenGui)
LoginFrame.Size = UDim2.new(0, 380, 0, 250)
LoginFrame.Position = UDim2.new(0.5, -190, 0.5, -125)
LoginFrame.BackgroundColor3 = Color3.fromRGB(10, 0, 20)
Instance.new("UIStroke", LoginFrame).Color = Color3.fromRGB(255, 0, 0)
Instance.new("UICorner", LoginFrame)

local KeyBox = Instance.new("TextBox", LoginFrame)
KeyBox.Size = UDim2.new(0.9, 0, 0, 50)
KeyBox.Position = UDim2.new(0.05, 0, 0.25, 0)
KeyBox.PlaceholderText = "D√ÅN B√ôA CH√ö V√ÄO ƒê√ÇY..."
KeyBox.TextScaled = true 
KeyBox.ClearTextOnFocus = false

local LoginBtn = Instance.new("TextButton", LoginFrame)
LoginBtn.Size = UDim2.new(0.45, 0, 0, 45)
LoginBtn.Position = UDim2.new(0.02, 0, 0.65, 0)
LoginBtn.Text = "GI·∫¢I B√ôA"
LoginBtn.BackgroundColor3 = Color3.fromRGB(150, 0, 0)

local GetKeyBtn = Instance.new("TextButton", LoginFrame)
GetKeyBtn.Size = UDim2.new(0.45, 0, 0, 45)
GetKeyBtn.Position = UDim2.new(0.52, 0, 0.65, 0)
GetKeyBtn.Text = "L·∫§Y B√ôA"
GetKeyBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)

-- [ MENU CH√çNH ] --
local MainMenu = Instance.new("Frame", ScreenGui)
MainMenu.Size = UDim2.new(0, 450, 0, 350)
MainMenu.Position = UDim2.new(0.5, -225, 0.5, -175)
MainMenu.Visible = false
MainMenu.BackgroundColor3 = Color3.fromRGB(5, 5, 5)
Instance.new("UIStroke", MainMenu).Color = Color3.fromRGB(255, 255, 255)

local function StartScript(kType, expiry)
    LoginFrame.Visible = false
    MainMenu.Visible = true
    
    -- Th√¥ng b√°o ph√°p thu·∫≠t
    local title = "TRI·ªÜU H·ªíI"
    local desc = (kType == "Admin") and "üåï CH√öA T·ªÇ PH√ÅP THU·∫¨T GI√ÅNG TH·∫æ!" or "‚ú® PHONG ·∫§N ƒê√É M·ªû!"
    game:GetService("StarterGui"):SetCore("SendNotification", {Title = title, Text = desc, Duration = 10})

    -- Ch·ª©c nƒÉng Auto Farm nh∆∞ c≈©
    local FarmBtn = Instance.new("TextButton", MainMenu)
    FarmBtn.Size = UDim2.new(0.9, 0, 0, 50)
    FarmBtn.Position = UDim2.new(0.05, 0, 0.2, 0)
    FarmBtn.Text = "AUTO FARM (STEAL A BRAINROT)"
    
    local active = false
    FarmBtn.MouseButton1Click:Connect(function()
        active = not active
        FarmBtn.BackgroundColor3 = active and Color3.new(0,1,0) or Color3.new(0.2,0.2,0.2)
        while active do
            pcall(function()
                for _, v in pairs(Workspace:GetDescendants()) do
                    if v:IsA("TouchTransmitter") then
                        Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.Parent.CFrame
                        wait(0.15)
                    end
                end
            end)
            wait(0.1)
        end
    end)
end

-- [ X·ª¨ L√ù ƒêƒÇNG NH·∫¨P ] --
LoginBtn.MouseButton1Click:Connect(function()
    -- Th√™m "?t=" ƒë·ªÉ tr√°nh b·ªã cache d·ªØ li·ªáu c≈© t·ª´ GitHub
    local success, response = pcall(function() 
        return game:HttpGet(Config.RawUrl .. "?nocache=" .. os.time()) 
    end)
    
    if success then
        local data = HttpService:JSONDecode(response)
        local inputKey = KeyBox.Text:gsub("%s+", "") -- Lo·∫°i b·ªè kho·∫£ng tr·∫Øng th·ª´a
        
        -- T√¨m ki·∫øm key trong Database (V√≤ng l·∫∑p ƒë·ªÉ tr√°nh l·ªói k√Ω t·ª± ƒë·∫∑c bi·ªát)
        local foundData = nil
        for keyInDb, value in pairs(data) do
            if keyInDb == inputKey then
                foundData = value
                break
            end
        end

        if foundData then
            if foundData.HWID ~= "" and foundData.HWID ~= Config.HWID then
                setclipboard(Config.HWID)
                Notify("L·ªñI", "M√£ m√°y kh√¥ng kh·ªõp! ƒê√£ copy HWID m·ªõi.")
                return
            end
            StartScript(foundData.Type, foundData.Expiry)
        else
            game:GetService("StarterGui"):SetCore("SendNotification", {Title = "L·ªñI", Text = "B√πa ch√∫ kh√¥ng hi·ªáu l·ª±c!"})
        end
    end
end)

GetKeyBtn.MouseButton1Click:Connect(function()
    setclipboard(Config.GetKeyLink)
    Notify("H·ªÜ TH·ªêNG", "ƒê√£ copy link l·∫•y key!")
end)
